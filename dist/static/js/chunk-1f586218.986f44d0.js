(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f586218"],{"328b":function(e,t,a){"use strict";a("6818")},6818:function(e,t,a){},e7ed:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{attrs:{id:"search"}},[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{placeholder:"姓名",clearable:""},model:{value:e.searchModel.username,callback:function(t){e.$set(e.searchModel,"username",t)},expression:"searchModel.username"}}),a("el-select",{attrs:{filterable:"",placeholder:"是否常用联系人"},model:{value:e.searchModel.isFrequent,callback:function(t){e.$set(e.searchModel,"isFrequent",t)},expression:"searchModel.isFrequent"}},[a("el-option",{attrs:{label:"是",value:"1"}}),a("el-option",{attrs:{label:"否",value:"0"}})],1),a("el-button",{attrs:{type:"primary",round:"",icon:"el-icon-search"},on:{click:e.getUserList}},[e._v("查询")]),a("el-button",{attrs:{round:""},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1),a("el-col",{attrs:{span:6,align:"right"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.openEditUI(null)}}},[e._v("新增")]),a("el-button",{attrs:{type:"info",plain:"",icon:"el-icon-upload2"},on:{click:e.handleImport}},[e._v("导入")]),a("el-button",{attrs:{type:"warning",plain:"",icon:"el-icon-download"},on:{click:e.downloadFile}},[e._v("导出")])],1)],1)],1),a("el-card",[a("el-table",{staticStyle:{width:"110%",height:"calc(100vh - 290px)"},attrs:{data:e.userList,stripe:""}},[a("el-table-column",{attrs:{label:"#",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.searchModel.pageNo-1)*e.searchModel.pageSize+t.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{prop:"id",label:"用户ID"}}),a("el-table-column",{attrs:{prop:"username",label:"姓名"}}),a("el-table-column",{attrs:{prop:"status",label:"用户状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-tag",[e._v("正常")]):a("el-tag",{attrs:{type:"danger"}},[e._v("禁用")])]}}])}),a("el-table-column",{attrs:{prop:"isFrequent",label:"是否常用联系人"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(a){return e.updateUserFrequent(t.row.id)}},model:{value:t.row.isFrequent,callback:function(a){e.$set(t.row,"isFrequent",a)},expression:"scope.row.isFrequent"}})]}}])}),a("el-table-column",{attrs:{prop:"detail",label:"联系方式",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.userContactDetails&&e.userContactName(t.row.userContactDetails))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",circle:""},on:{click:function(a){return e.openEditUI(t.row.id)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(a){return e.deleteUser(t.row)}}})]}}])})],1)],1),a("el-pagination",{attrs:{"current-page":e.searchModel.pageNo,"page-sizes":[5,10,20,50],"page-size":e.searchModel.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{width:"600px",title:e.title,visible:e.dialogFormVisible},on:{close:e.clearForm,"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"userFormRef",attrs:{model:e.userForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"姓名",prop:"username","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),null==e.userForm.id||void 0==e.userForm.id?a("el-form-item",{attrs:{label:"登录密码",prop:"password","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1):e._e(),a("el-form-item",{attrs:{label:"用户状态","label-width":e.formLabelWidth}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.userForm.status,callback:function(t){e.$set(e.userForm,"status",t)},expression:"userForm.status"}})],1),a("el-form-item",{attrs:{label:"是否常用联系人","label-width":e.formLabelWidth}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.userForm.isFrequent,callback:function(t){e.$set(e.userForm,"isFrequent",t)},expression:"userForm.isFrequent"}})],1),a("el-button",{staticClass:"addItemBtn",attrs:{type:"primary",plain:""},on:{click:e.addItem}},[e._v("增加联系方式")]),e._l(e.userForm.userContactDetails,(function(t,r){return a("div",{key:r,staticClass:"inline"},[a("el-form-item",{attrs:{label:"联系方式类型"+(r+1)}},[a("el-input",{attrs:{placeholder:"请选择联系方式类型",autocomplete:"off"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"userContact.name"}})],1),a("el-form-item",{attrs:{label:"联系方式详情"+(r+1)}},[a("el-input",{attrs:{placeholder:"请选择联系方式详情",autocomplete:"off"},model:{value:t.detail,callback:function(a){e.$set(t,"detail",a)},expression:"userContact.detail"}})],1),a("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.delItem(r)}}},[e._v("删除")])],1)}))],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveUser}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"el-upload-dialog",attrs:{title:e.upload.title,visible:e.upload.open,width:"400px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.upload,"open",t)}}},[a("el-upload",{ref:"upload",attrs:{limit:1,accept:".xlsx, .xls",headers:e.upload.headers,action:"http://36.137.185.208:8204/prod-api/user/importData",disabled:e.upload.isUploading,"on-progress":e.handleFileUploadProgress,"on-success":e.handleFileSuccess,"auto-upload":!1,drag:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.importTemplate}},[e._v("导入模板")])],1),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitFileForm}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.upload.open=!1}}},[e._v("取 消")])],1)])],1)],1)},s=[],o=a("c7eb"),l=a("1da1"),n=(a("a15b"),a("d81d"),a("a434"),a("b0c0"),a("d3b7"),a("ac1f"),a("00b4"),a("3ca3"),a("ddb0"),a("2b3d"),a("bf19"),a("9861"),a("b775")),i={getUserList:function(e){return Object(n["a"])({url:"/user/list",method:"get",params:{pageNo:e.pageNo,pageSize:e.pageSize,username:e.username,phone:e.phone,isFrequent:e.isFrequent}})},addUser:function(e){return Object(n["a"])({url:"/user",method:"post",data:e})},updateUser:function(e){return Object(n["a"])({url:"/user",method:"put",data:e})},saveUser:function(e){return null==e.id&&void 0==e.id?this.addUser(e):this.updateUser(e)},getUserById:function(e){return Object(n["a"])({url:"/user/".concat(e),method:"get"})},deleteUserById:function(e){return Object(n["a"])({url:"/user/".concat(e),method:"delete"})},downloadTemplate:function(){return Object(n["a"])({url:"/user/importTemplate",method:"get",responseType:"blob"})},downloadFile:function(e){return Object(n["a"])({url:"/user/export",method:"get",responseType:"blob",params:{pageNo:e.pageNo,pageSize:e.pageSize,username:e.username,phone:e.phone,isFrequent:e.isFrequent}})},updateUserFrequent:function(e){return Object(n["a"])({url:"/user/editIsFrequentById",method:"post",params:{id:e}})}},u=a("5f87"),c={data:function(){var e=function(e,t,a){var r=/^[a-zA-Z0-9]+([-_.][a-zA-Z0-9]+)*@[a-zA-Z0-9]+([-_.][a-zA-Z0-9]+)*\.[a-z]{2,}$/;if(!r.test(t))return a(new Error("邮箱格式错误"));a()};return{formLabelWidth:"110px",userForm:{userContactDetails:[{name:"",detail:""}]},dialogFormVisible:!1,title:"",total:0,searchModel:{pageNo:1,pageSize:10},userList:[],rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"长度在 3 到 50 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入登录初始密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入电子邮件",trigger:"blur"},{validator:e,trigger:"blur"}]},Loading:!1,homeAddressList:["公司地址","家庭地址"],companyAddressList:["福建省福州市软件园","福州市西湖"],upload:{open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Object(u["a"])()},url:"http://36.137.185.208:8204/prod-api/system/user/importData"}}},methods:{resetForm:function(){this.searchModel.pageNo=1,this.searchModel.pageSize=10,this.searchModel.username="",this.searchModel.phone="",this.searchModel.isFrequent="",this.getUserList()},userContactName:function(e){var t=[];return e&&e.map((function(e){t.push(e.name+":"+e.detail)})),t.join(",")},addItem:function(){this.userForm.userContactDetails.push({name:"",detail:""}),console.log(this.userForm.userContactDetails)},delItem:function(e){this.userForm.userContactDetails.splice(e,1)},handleImport:function(){this.upload.title="导入",this.upload.open=!0},importTemplate:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,r,s,l;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.downloadTemplate();case 2:a=t.sent,r=a,s=[],l="下载模板.xlsx",s.push(r),e.downloadExcelFile(s,l);case 8:case"end":return t.stop()}}),t)})))()},handleFileUploadProgress:function(e,t,a){this.upload.isUploading=!0},handleFileSuccess:function(e,t,a){this.upload.open=!1,this.upload.isUploading=!1,this.$refs.upload.clearFiles(),this.getUserList()},submitFileForm:function(){this.$refs.upload.submit()},updateUserFrequent:function(e){var t=this;i.updateUserFrequent(e).then((function(e){t.$message({type:"success",message:e.message})}))},downloadFile:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a,r,s,l;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.downloadFile(e.searchModel);case 2:a=t.sent,r=a,s=[],l="导出模板.xlsx",s.push(r),e.downloadExcelFile(s,l);case 8:case"end":return t.stop()}}),t)})))()},downloadExcelFile:function(e,t){var a=window.URL.createObjectURL(new Blob(e)),r=document.createElement("a");r.style.display="none",r.href=a,r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)},deleteUser:function(e){var t=this;this.$confirm("您确认删除用户 ".concat(e.username," ?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.deleteUserById(e.id).then((function(e){t.$message({type:"success",message:e.message}),t.getUserList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},saveUser:function(){var e=this;this.$refs.userFormRef.validate((function(t){if(!t)return console.log("error submit!!"),!1;i.saveUser(e.userForm).then((function(t){e.$message({message:t.message,type:"success"}),e.dialogFormVisible=!1,e.getUserList()}))}))},clearForm:function(){this.userForm={},this.$refs.userFormRef.clearValidate()},openEditUI:function(e){var t=this;null==e?this.title="新增联系人":(this.title="修改用户",i.getUserById(e).then((function(e){t.userForm=e.data}))),this.dialogFormVisible=!0},handleSizeChange:function(e){this.searchModel.pageSize=e,this.getUserList()},handleCurrentChange:function(e){this.searchModel.pageNo=e,this.getUserList()},getUserList:function(){var e=this;i.getUserList(this.searchModel).then((function(t){e.userList=t.data.rows,e.total=t.data.total}))}},created:function(){this.getUserList()}},d=c,p=(a("328b"),a("2877")),m=Object(p["a"])(d,r,s,!1,null,null,null);t["default"]=m.exports}}]);